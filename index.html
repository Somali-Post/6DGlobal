<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>6D Address - Global Demonstrator</title>
    <link rel="stylesheet" href="global-map.css">
</head>
<body>
    <div id="map"></div>

    <div id="logo">
        <img src="public/assets/logo.png" alt="6D Address Logo">
    </div>

    <button id="geolocate-btn" title="Find My Location">
        <img src="public/assets/geolocate.svg" alt="Find My Location">
    </button>

    <div class="experience-overlay" id="experience-overlay">
        <button class="overlay-toggle" id="overlay-toggle" aria-expanded="true" aria-controls="experience-overlay-card">
            <span class="toggle-icon">⤢</span>
            <span class="toggle-text">Close</span>
        </button>
        <div class="overlay-card" id="experience-overlay-card">
            <div class="overlay-sections">
                <section class="overlay-section hero overlay-animated" style="--offset:0">
                    <h1>6D Address</h1>
                    <p class="lede">
                        A memorable six-digit code generated from latitude and longitude coordinates. Working with existing address information it provides accuracy within 10 metres.
                    </p>
                </section>
                <section class="overlay-section overlay-animated" style="--offset:1">
                    <h3>Why 6D Address?</h3>
                    <p>Why should you implement 6D Address in your country?</p>
                    <ul>
                        <li>Built on millennia-old latitude and longitude knowledge</li>
                        <li>Works in informal &amp; unmapped areas</li>
                        <li>Global and future-proof</li>
                        <li>Multi-sector applicability</li>
                        <li>Speed and cost of implementation</li>
                    </ul>
                </section>
                <section class="overlay-section overlay-animated" style="--offset:2">
                    <h3>6D Address Licensing</h3>
                    <p>6D Address is licensing partners to implement 6D Address worldwide. There are three license types:</p>
                    <ul>
                        <li>National exclusive license for commercial ownership within a country</li>
                        <li>National non-commercial license for domestic use</li>
                        <li>Global non-commercial license for worldwide initiatives</li>
                    </ul>
                </section>
                <section class="overlay-section overlay-animated highlight" style="--offset:3">
                    <h3>Why become a 6D Address Licensee?</h3>
                    <p>Becoming a 6D licensee offers multiple commercial opportunities:</p>
                    <ul>
                        <li>Create a 6D Address Register for onward licensing</li>
                        <li>Address informal settlements</li>
                        <li>Improve tax collection and land administration</li>
                        <li>Enable social inclusion via address verification</li>
                        <li>Accelerate financial inclusion through trusted location identity</li>
                    </ul>
                </section>
            </div>
            <section class="overlay-section overlay-cta-block overlay-animated" style="--offset:4">
                <div>
                    <p class="cta-label">Contact</p>
                    <p class="cta-subtext">Want to explore 6D Address for your country? Our team will answer any queries you have about national applications, commercial opportunities, licensing, and demonstrations.</p>
                </div>
                <div class="cta-actions">
                    <button id="open-contact">Speak with our team</button>
                </div>
            </section>
        </div>
        <button class="scroll-indicator" id="overlay-scroll-indicator" type="button" aria-label="Scroll for more information">
            <span aria-hidden="true">⌄</span>
        </button>
    </div>

    <div id="contact-panel" aria-hidden="true">
        <div class="contact-card">
            <button id="close-contact" aria-label="Close contact form">&times;</button>
            <p class="eyebrow">Partner with us</p>
            <h2>Schedule a private demo</h2>
            <p class="lede">Tell us about your program and we will share licensing models, APIs, and pilot timelines.</p>
            <form id="contact-form">
                <div class="form-row">
                    <label for="contact-name">Full name</label>
                    <input type="text" id="contact-name" name="name" required>
                </div>
                <div class="form-row">
                    <label for="contact-organization">Organization</label>
                    <input type="text" id="contact-organization" name="organization" required>
                </div>
                <div class="form-row">
                    <label for="contact-email">Work email</label>
                    <input type="email" id="contact-email" name="email" required>
                </div>
                <div class="form-row">
                    <label for="contact-message">Program vision</label>
                    <textarea id="contact-message" name="message" rows="3" required></textarea>
                </div>
                <button type="submit" class="primary">Send request</button>
                <p class="form-note" id="contact-feedback" role="status"></p>
            </form>
        </div>
    </div>

    <div id="info-panel">
        <div id="code-display"></div>
        <div id="address-display">
            <div id="line1-display">Click on the map to generate</div>
            <div id="line2-display">a 6D Address</div>
            <div id="line3-display"></div>
        </div>
    </div>

    <script type="module">
        window.addEventListener('DOMContentLoaded', () => {
            const contactPanel = document.getElementById('contact-panel');
            const openBtn = document.getElementById('open-contact');
            const closeBtn = document.getElementById('close-contact');
            const form = document.getElementById('contact-form');
            const feedback = document.getElementById('contact-feedback');
            const overlay = document.getElementById('experience-overlay');
            const overlayToggle = document.getElementById('overlay-toggle');
            const overlayToggleText = overlayToggle?.querySelector('.toggle-text');
            const overlayToggleIcon = overlayToggle?.querySelector('.toggle-icon');
            const overlayCard = document.getElementById('experience-overlay-card');
            const scrollIndicator = document.getElementById('overlay-scroll-indicator');

            function togglePanel(show) {
                contactPanel.setAttribute('aria-hidden', String(!show));
                document.body.classList.toggle('panel-open', show);
            }

            openBtn?.addEventListener('click', () => togglePanel(true));
            closeBtn?.addEventListener('click', () => togglePanel(false));
            contactPanel?.addEventListener('click', (event) => {
                if (event.target === contactPanel) {
                    togglePanel(false);
                }
            });

            function setOverlayState(collapsed, options = { animate: true }) {
                overlay?.classList.toggle('collapsed', collapsed);
                overlayToggle?.setAttribute('aria-expanded', String(!collapsed));
                if (overlayToggleText) {
                    overlayToggleText.textContent = collapsed ? "What's 6D Address?" : 'Close';
                }
                if (overlayToggleIcon) {
                    overlayToggleIcon.textContent = collapsed ? '＋' : '⤢';
                }
                if (collapsed) {
                    overlayCard?.classList.remove('ready');
                    scrollIndicator?.classList.add('hidden');
                } else if (options.animate !== false) {
                    triggerOverlayAnimation();
                }
                updateScrollIndicator();
            }

            function triggerOverlayAnimation() {
                if (!overlayCard) return;
                overlayCard.classList.remove('ready');
                void overlayCard.offsetWidth;
                overlayCard.classList.add('ready');
                setTimeout(updateScrollIndicator, 350);
            }

            function updateScrollIndicator() {
                if (!overlayCard || !scrollIndicator) return;
                const extra = overlayCard.scrollHeight - overlayCard.clientHeight;
                if (extra <= 8) {
                    scrollIndicator.classList.add('hidden');
                    return;
                }
                const atBottom = overlayCard.scrollTop + overlayCard.clientHeight >= overlayCard.scrollHeight - 4;
                scrollIndicator.classList.toggle('hidden', atBottom);
            }

            overlayToggle?.addEventListener('click', () => {
                const nextState = !(overlay?.classList.contains('collapsed'));
                setOverlayState(nextState);
            });

            overlayCard?.addEventListener('scroll', updateScrollIndicator);
            window.addEventListener('resize', () => updateScrollIndicator());

            form?.addEventListener('submit', (event) => {
                event.preventDefault();
                feedback.textContent = 'Thanks! We will respond within one business day.';
                form.reset();
            });

            setOverlayState(false, { animate: false });
            setTimeout(triggerOverlayAnimation, 220);
        });
    </script>
    <script type="module" src="public/app/global-map.js"></script>
</body>
</html>
